<?xml version="1.0"?>
<project name="spacesettlers" basedir=".">
	<description>
  	Ant build file for compiling and running Space Settlers
  </description>

	<!-- src: root directory for the main codebase. -->
	<property name="src" value="src" />

	<!-- build: staging directory for any files generated by the build. -->
	<property name="build" value="build" />

	<!-- lib: directory for third party jars shipped with the project. -->
	<property name="lib" value="lib" />

	<!-- dist: target directory for generated distributables. -->
	<property name="dist" value="dist" />

	<!-- docs: directory containing the project's javadocs -->
	<property name="docs" value="docs/api" />

	<!-- clean: blow away any and all generated files. -->
	<target name="clean">
		<delete dir="${build}" />
		<delete dir="${dist}" />
		<delete dir="${docs}" />
	</target>

	<!-- init: the first step of any build. -->
	<target name="init">
		<tstamp />
		<mkdir dir="${build}" />
		<mkdir dir="${dist}" />
		<mkdir dir="${docs}" />
	</target>

	<!-- Make 3rd-party libs accessible to tasks. -->
	<path id="lib.classpath">
		<fileset dir="${lib}" includes="*.jar" />
	</path>


	<!-- Make the jars -->
	<target name="compile-all" depends="init">
		<javac debug="on" srcdir="${src}"
           destdir="${build}"
           includes="**"
           source="1.7">
			<classpath refid="lib.classpath" />
		</javac>
	</target>

	<!-- Jar all the jars into one (because ant won't do it otherwise).  This comes from a hint here
	http://stackoverflow.com/questions/515428/clean-way-to-combine-multiple-jars-preferably-using-ant
	 -->	
	<target name="jar-spacesettlers" depends="compile-all">
		<unzip dest="${build}">
			<fileset dir="${lib}">
				<include name="**/*.jar" />
			</fileset>
		</unzip>
		<jar destfile="${dist}/spacesettlers.jar"
         basedir="${build}" >
		</jar>
	</target>


	<!-- Projects:
	The following is a list of all the ways to run spacewar
  -->
	<target name="spacesettlers-human" depends="jar-spacesettlers">
		<java classname="spacesettlers.simulator.RunSimulator"
		      fork="true" 
		      dir="src"
			  classpath="${dist}/spacesettlers.jar">
			<jvmarg	value="-Xmx10G" />
			<arg line="--graphics true "/>
			<arg line="--configPath ../config/human/"/>
			<arg line="--simulatorConfigFile SpaceSettlersConfig.xml"/>
			<classpath>
				<pathelement location="${dist}/spacesettlers.jar"/>
			</classpath>
		</java>
	</target>
	
    <target name="testLadder" depends="jar-spacesettlers">
            <java classname="spacesettlers.ladder.RunLadder"
                  fork="true"
                  dir="src"
                      classpath="${dist}/spacesettlers.jar">
	        <jvmarg value="-Xmx10G" />
                    <arg line="--graphics false "/>
		<arg line="--configPath ../config/ladder/"/>
                <arg line="--simulatorConfigFile SpaceSettlersConfig.xml"/>
                    <arg line="--ladderConfigFile SelfLadderConfig.xml"/>
                    <classpath>
                        <pathelement location="${dist}/spacesettlers.jar"/>
                    </classpath>
            </java>
	</target>
	
    <target name="coopLadder" depends="jar-spacesettlers">
            <java classname="spacesettlers.ladder.RunLadder"
                  fork="true"
                  dir="src"
                      classpath="${dist}/spacesettlers.jar">
	        <jvmarg value="-Xmx10G" />
                    <arg line="--graphics false "/>
		<arg line="--configPath ../config/heuristicCooperative/"/>
                <arg line="--simulatorConfigFile SpaceSettlersConfig.xml"/>
                    <arg line="--ladderConfigFile LadderConfig.xml"/>
                    <classpath>
                        <pathelement location="${dist}/spacesettlers.jar"/>
                    </classpath>
            </java>
	</target>
	
    <target name="competeLadder" depends="jar-spacesettlers">
            <java classname="spacesettlers.ladder.RunLadder"
                  fork="true"
                  dir="src"
                      classpath="${dist}/spacesettlers.jar">
	        <jvmarg value="-Xmx10G" />
                    <arg line="--graphics false "/>
		<arg line="--configPath ../config/heuristicCompetitive/"/>
                <arg line="--simulatorConfigFile SpaceSettlersConfig.xml"/>
                    <arg line="--ladderConfigFile LadderConfig.xml"/>
                    <classpath>
                        <pathelement location="${dist}/spacesettlers.jar"/>
                    </classpath>
            </java>
	</target>

	<target name="spacesettlers-coop" depends="jar-spacesettlers">
		<java classname="spacesettlers.simulator.RunSimulator"
		      fork="true" 
		      dir="src"
			  classpath="${dist}/spacesettlers.jar">
			<jvmarg	value="-Xmx10G" />
			<arg line="--graphics true "/>
			<arg line="--configPath ../config/heuristicCooperative/"/>
			<arg line="--simulatorConfigFile SpaceSettlersConfig.xml"/>
			<classpath>
				<pathelement location="${dist}/spacesettlers.jar"/>
			</classpath>
		</java>
	</target>

	<target name="spacesettlers-compete" depends="jar-spacesettlers">
		<java classname="spacesettlers.simulator.RunSimulator"
		      fork="true" 
		      dir="src"
			  classpath="${dist}/spacesettlers.jar">
			<jvmarg	value="-Xmx10G" />
			<arg line="--graphics true "/>
			<arg line="--configPath ../config/heuristicCompetitive/"/>
			<arg line="--simulatorConfigFile SpaceSettlersConfig.xml"/>
			<classpath>
				<pathelement location="${dist}/spacesettlers.jar"/>
			</classpath>
		</java>
	</target>

	
	<target name="doc" depends="init">
	    <javadoc destdir="docs/api"
	             author="true"
	             version="true"
	             use="true"
	             windowtitle="SpaceSettlers API"
	    		 overview="src/spacesettlers/overview.html">
	      <packageset dir="src" defaultexcludes="yes">
	        <include name="spacesettlers/*" />
	      </packageset>
	      <doctitle>
	        <![CDATA[<h1>Spacewar2 API</h1>]]>
	      </doctitle>
	      <bottom>
	        <![CDATA[<i>Copyright &#169; 2015 University of Oklahoma. All Rights Reserved.</i>]]>
	      </bottom>
	    </javadoc>
	  </target>

	
</project>

